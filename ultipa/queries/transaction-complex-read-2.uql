n({@Person && _id==$id}).re({@Own}).n({@Account} as account1)
n(account1).le({@Transfer.timestamp <> [$startTime,$endTime] && @Transfer.timestamp<prev_e.@Transfer.timestamp})[1:3].n({@Account} as other).le({@Deposit.timestamp <> [$startTime,$endTime]} as deposit).n({@Loan} as loan) as path
group by other._id
return table(other._id,count(path),sum(deposit.amount))